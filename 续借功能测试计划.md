# 续借功能测试计划

## 功能概述
为学生用户提供图书续借功能，默认续借一个月（30天）。

## 测试场景

### 场景1：正常续借流程
1. **前置条件**：
   - 学生用户已借阅某本图书
   - 图书状态为已借出
   - 当前日期在借阅期内

2. **测试步骤**：
   - 以学生身份登录系统
   - 点击"🔄 续借"按钮
   - 选择要续借的图书
   - 确认续借操作

3. **预期结果**：
   - 显示续借成功提示
   - 图书的应还日期延长30天
   - 数据文件中的dueDate字段更新

### 场景2：权限验证
1. **前置条件**：
   - 以管理员身份登录系统

2. **测试步骤**：
   - 点击"🔄 续借"按钮

3. **预期结果**：
   - 显示权限错误提示："只有学生用户可以续借"

### 场景3：无借阅记录
1. **前置条件**：
   - 学生用户当前没有借阅任何图书

2. **测试步骤**：
   - 点击"🔄 续借"按钮

3. **预期结果**：
   - 显示提示信息："你当前没有借阅任何图书！"

### 场景4：数据持久性验证
1. **前置条件**：
   - 续借操作成功完成

2. **测试步骤**：
   - 退出程序
   - 重新启动程序
   - 查看同一用户的借阅记录

3. **预期结果**：
   - 续借后的到期日期保持不变
   - 数据正确保存到book_copies.json文件中

## 数据验证点

### book_copies.json文件变化
续借前后，对应副本的dueDate字段应该发生变化：

**续借前**：
```json
{
    "borrowDate": "2025-11-21",
    "borrowedBy": "111",
    "copyId": "CS001_1",
    "copyNumber": 1,
    "dueDate": "2025-12-21",
    "indexId": "CS001"
}
```

**续借后**：
```json
{
    "borrowDate": "2025-11-21",
    "borrowedBy": "111",
    "copyId": "CS001_1",
    "copyNumber": 1,
    "dueDate": "2026-01-20",  // 延长30天
    "indexId": "CS001"
}
```

## 测试数据准备
需要确保有以下测试数据：
- 已借出且即将到期的图书副本
- 不同用户的借阅记录
- 管理员账户和学生账户

## 用户体验测试要点
1. **界面友好性**：续借按钮只对学生用户可见
2. **信息清晰**：显示当前应还日期和续借后的新应还日期
3. **操作确认**：提供确认对话框防止误操作
4. **状态反馈**：续借成功/失败的明确提示
5. **排序逻辑**：按到期日期排序，最紧急的图书优先显示

## 完成标准
- 所有测试场景通过
- 数据持久性验证正确
- 用户体验符合预期
- 代码编译无错误和警告